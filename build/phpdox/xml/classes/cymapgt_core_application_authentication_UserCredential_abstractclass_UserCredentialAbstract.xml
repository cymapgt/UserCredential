<?xml version="1.0" encoding="UTF-8"?>
<class xmlns="http://xml.phpdox.net/src" full="cymapgt\core\application\authentication\UserCredential\abstractclass\UserCredentialAbstract" namespace="cymapgt\core\application\authentication\UserCredential\abstractclass" name="UserCredentialAbstract" abstract="true" final="false" start="38" end="774">
  <file path="/home/rhossis/NetBeansProjects/cymapgt/core/application/authentication/UserCredential/src/abstractclass" file="UserCredentialAbstract.php" realpath="/home/rhossis/NetBeansProjects/cymapgt/core/application/authentication/UserCredential/src/abstractclass/UserCredentialAbstract.php" size="32192" time="2015-05-13T15:02:45+03:00" unixtime="1431518565" sha1="18505d051946880b32edb546bdb4dc44f9763c1b" relative="abstractclass/UserCredentialAbstract.php"/>
  <docblock>
    <description compact="UserCredential This service implements user password policy as well as facilitating plugging in to log in infrastructures that utilize SSO via LDAP and one time password logging in via OATH and SecureId"/>
    <category/>
    <package value="cymapgt.core.application.authentication.UserCredential"/>
    <copyright value="Copyright (c) 2014 Cymap"/>
    <author value="Cyril Ogana &lt;cogana@gmail.com&gt;"/>
    <abstract>The objectives of the user credential class are:
     - Add password entropy component â€“ suggestion and enforcement
     - Add ability to choose number of simultaneous logins allowed for users
     - Add ability to choose user allowed login devices
     - Add ability to choose user allowed login IP/host
     - Add ability to choose user  allowed log in days
     - Add ability to choose user allowed log in time
     - Add ability to set the tenor of the user account in the system
     - Add ability to reset a users password
     - Add ability to lock users passwords for violation of system rules
     - Two factor authentication component
     - Password expiry frequency component
     - RSA one time password authentication component
     - Embed the user management module to the maker-checker module process such that if required, any creation/update of users information requires 2, 3 or N step authentication e.g. created by, modified by
     - Add option to email a user that a new account has been created on his/her behalf
     - The password hash should be at least sha256

     - See http://www.owasp.org/images/0/08/OWASP_SCP_Quick_Reference_Guide_v2.pdf</abstract>
  </docblock>
  <member name="_userProfile" type="array" visibility="private" line="40"/>
  <member name="_baseEntropySetting" type="array" visibility="private" line="42"/>
  <member name="_baseEntropyOverride" type="{unknown}" default="false" visibility="private" line="43"/>
  <member name="_udfEntropySetting" type="array" visibility="private" line="44"/>
  <member name="_basePasswordPolicy" type="array" visibility="private" line="46"/>
  <member name="_udfPasswordPolicy" type="array" visibility="private" line="47"/>
  <constructor name="__construct" start="51" end="53" abstract="false" final="false" static="false" visibility="public">
    <parameter name="userProfile" byreference="false" type="{unknown}"/>
  </constructor>
  <method name="_initialize" start="63" end="67" abstract="false" final="false" static="false" visibility="private">
    <docblock>
      <description compact="function initialize() - Initialize the classes default settings Cyril Ogana &lt;cogana@gmail.com&gt; - 2013-05-13"/>
      <param description="/ object  userProfile" type="array"/>
      <access value="private"/>
    </docblock>
    <parameter name="userProfile" byreference="false" type="{unknown}"/>
  </method>
  <method name="_initializeProfile" start="78" end="96" abstract="false" final="false" static="false" visibility="private">
    <docblock>
      <description compact="function initializeProfile() - Function to initialize user profile data">Cyril Ogana &lt;cogana@gmail.com&gt; - 2013-05-13</description>
      <param description="/ object $userProfile" type="array"/>
      <access value="private"/>
    </docblock>
    <parameter name="userProfile" byreference="false" type="{unknown}"/>
    <inline>
      <comment value="validate that user profile has the correct information" line="79"/>
      <todo value="throw exception here" line="92"/>
    </inline>
  </method>
  <method name="_initializeBaseEntropy" start="105" end="130" abstract="false" final="false" static="false" visibility="private">
    <docblock>
      <description compact="function initializeBaseEntropy() = Initialize to hard coded default base tntropy Cyril Ogana &lt;cogana@gmail.com&gt; 2013-05-13"/>
      <access value="private"/>
    </docblock>
    <inline>
      <comment value="initialize if not already initialized as array" line="106"/>
    </inline>
  </method>
  <method name="_initializeBasePasswordPolicy" start="139" end="145" abstract="false" final="false" static="false" visibility="private">
    <docblock>
      <description compact="function _initializeBasePasswordPolicy() = Initialize to hard coded default base policy Cyril Ogana &lt;cogana@gmail.com&gt; 2014-02-11"/>
      <access value="private"/>
    </docblock>
  </method>
  <method name="_getBaseEntropy" start="157" end="161" abstract="false" final="true" static="false" visibility="protected">
    <docblock>
      <description compact="function getBaseEntropy() = Get the base entropy data structure Cyril Ogana &lt;cogana@gmail.com&gt; 2013-05-13"/>
      <return description="/ Object" type="array"/>
      <access value="protected"/>
      <final/>
    </docblock>
  </method>
  <method name="_getBasePasswordPolicy" start="173" end="177" abstract="false" final="true" static="false" visibility="protected">
    <docblock>
      <description compact="function getBasePasswordPolicy() = Get the base password policy Cyril Ogana &lt;cogana@gmail.com&gt; 2014-02-11"/>
      <return description="/ Object" type="array"/>
      <access value="protected"/>
      <final/>
    </docblock>
  </method>
  <method name="_setUdfEntropy" start="189" end="270" abstract="false" final="true" static="false" visibility="protected">
    <docblock>
      <description compact="function setUdfEntropy() = Set the user defined entropy setting Cyril Ogana &lt;cogana@gmail.com&gt; 2013-05-13"/>
      <param description="/ object entropyObj - array or object implementing ArrayAccess" type="array"/>
      <access value="protected"/>
      <final/>
    </docblock>
    <parameter name="entropyObj" byreference="false" type="{unknown}"/>
    <inline>
      <comment value="initialize if not already initialized as array" line="190"/>
      <comment value="validate the array / object" line="200"/>
      <todo value="throw exception here" line="205"/>
      <comment value="validate that minimum password len has the correct indices, then set it" line="210"/>
      <todo value="throw exception here" line="214"/>
      <comment value="validate that uppercase snippet has correct indices, then set it" line="219"/>
      <todo value="throw exception here" line="227"/>
      <comment value="validate that lowercase snippet has correct indices, then set it" line="232"/>
      <todo value="throw exception here" line="240"/>
      <comment value="validate that numeric chars snippet has correct indices, then set it" line="245"/>
      <todo value="throw exception here" line="253"/>
      <comment value="validate that special chars snippet has correct indices, then set it" line="258"/>
      <todo value="throw exception here" line="266"/>
    </inline>
  </method>
  <method name="_setUdfPasswordPolicy" start="282" end="338" abstract="false" final="true" static="false" visibility="protected">
    <docblock>
      <description compact="function setUdfPasswordPolicy() = Set the user defined password policy Cyril Ogana &lt;cogana@gmail.com&gt; 2013-05-13"/>
      <param description="/ object entropyObj - array or object implementing ArrayAccess" type="array"/>
      <access value="protected"/>
      <final/>
    </docblock>
    <parameter name="entropyObj" byreference="false" type="{unknown}"/>
    <inline>
      <comment value="initialize if not already initialized as array" line="283"/>
      <comment value="validate the array / object" line="293"/>
      <todo value="throw exception here" line="298"/>
      <comment value="validate that illegal attempts limit has correct indices, then set it" line="303"/>
      <todo value="throw exception here" line="307"/>
      <comment value="validate that password reset frequency has correct indices, then set it" line="312"/>
      <todo value="throw exception here" line="316"/>
      <comment value="validate that passwordd repeat minimum has correct indices, then set it" line="321"/>
      <todo value="throw exception here" line="325"/>
      <comment value="validate that password repeat minimum has correct indices, then set it" line="330"/>
      <todo value="throw exception here" line="334"/>
    </inline>
  </method>
  <method name="_getUdfEntropy" start="350" end="354" abstract="false" final="true" static="false" visibility="protected">
    <docblock>
      <description compact="function getUdfEntropy() = Get the udf entropy data structure Cyril Ogana &lt;cogana@gmail.com&gt; 2013-05-13"/>
      <return description="/ Object" type="array"/>
      <access value="protected"/>
      <final/>
    </docblock>
  </method>
  <method name="_getUdfPasswordPolicy" start="366" end="370" abstract="false" final="true" static="false" visibility="protected">
    <docblock>
      <description compact="function getUdfPasswordPolicy() = Get the udf password policy Cyril Ogana &lt;cogana@gmail.com&gt; 2014-02-11"/>
      <return description="/ Object" type="array"/>
      <access value="protected"/>
      <final/>
    </docblock>
  </method>
  <method name="_setBaseEntropyOverride" start="384" end="390" abstract="false" final="true" static="false" visibility="protected">
    <docblock>
      <description compact="function setBaseEntropyOverride() = Set the value of base entropy Cyril Ogana &lt;cogana@gmail.com&gt; 2013-05-13"/>
      <param description="toggle - True or false to toggle the attribute" type="object">
        <type full="cymapgt\core\application\authentication\UserCredential\abstractclass\bool" namespace="cymapgt\core\application\authentication\UserCredential\abstractclass" name="bool"/>
      </param>
      <return type="object">
        <type full="cymapgt\core\application\authentication\UserCredential\abstractclass\void" namespace="cymapgt\core\application\authentication\UserCredential\abstractclass" name="void"/>
      </return>
      <access value="protected"/>
      <final/>
    </docblock>
    <parameter name="toggle" byreference="false" type="{unknown}"/>
  </method>
  <method name="_getBaseEntropyOverride" start="402" end="406" abstract="false" final="true" static="false" visibility="protected">
    <docblock>
      <description compact="function getBaseEntropyOverride = Get the current value of base entropy override attrib Cyril Ogana &lt;cogana@gmail.com&gt; 2013-05-13"/>
      <return type="object">
        <type full="cymapgt\core\application\authentication\UserCredential\abstractclass\bool" namespace="cymapgt\core\application\authentication\UserCredential\abstractclass" name="bool"/>
      </return>
      <access value="protected"/>
      <final/>
    </docblock>
  </method>
  <method name="_regexBuildPattern" start="420" end="445" abstract="false" final="false" static="false" visibility="private">
    <docblock>
      <description compact="function regexBuildPattern() - build simple regex patterns based on the settings Cyril Ogana &lt;cogana@gmail.com&gt; 2013-05-13"/>
      <param description="patternCode - integer representing defined constants for variable code" type="int"/>
      <param description="matchCount - integer representing the count of matched transactions" type="int"/>
      <return type="string"/>
      <access value="private"/>
    </docblock>
    <parameter name="patternCode" byreference="false" type="{unknown}"/>
    <parameter name="matchCount" byreference="false" type="{unknown}"/>
    <inline>
      <todo value="Throw exception here" line="440"/>
    </inline>
  </method>
  <method name="_getPasswordEntropyDescription" start="457" end="501" abstract="false" final="true" static="false" visibility="protected">
    <docblock>
      <description compact="function _getPasswordEntropyDescription() - get a description of the required password entropy Cyril Ogana &lt;cogana@gmail.com&gt; 2014-02-11"/>
      <return type="string"/>
      <access value="protected"/>
      <final/>
    </docblock>
  </method>
  <method name="_getPasswordLengthDescription" start="513" end="521" abstract="false" final="true" static="false" visibility="protected">
    <docblock>
      <description compact="function _getPasswordLengthDescription() - get a description of the required password entropy Cyril Ogana &lt;cogana@gmail.com&gt; 2014-02-11"/>
      <return type="string"/>
      <access value="protected"/>
      <final/>
    </docblock>
  </method>
  <method name="_getPasswordPolicyDescription" start="523" end="551" abstract="false" final="true" static="false" visibility="protected">
    <parameter name="policyType" byreference="false" type="{unknown}"/>
  </method>
  <method name="_validateEntropy" start="563" end="646" abstract="false" final="true" static="false" visibility="protected">
    <docblock>
      <description compact="function validateEntropy() - validate the entropy of the password in the userprofile Cyril Ogana &lt;cogana@gmail.com&gt; 2013-05-13"/>
      <return type="object">
        <type full="cymapgt\core\application\authentication\UserCredential\abstractclass\bool" namespace="cymapgt\core\application\authentication\UserCredential\abstractclass" name="bool"/>
      </return>
      <access value="protected"/>
      <final/>
    </docblock>
    <inline>
      <comment value="validate that required indices exist" line="564"/>
      <todo value="Throw exception here" line="570"/>
      <comment value="validate that user is not using part of username as password" line="574"/>
      <comment value="determine which entropy to use (base or udf)" line="593"/>
      <comment value="build the password entropy regex uppercase" line="599"/>
      <todo value="Implement as constants the patterns" line="601"/>
      <comment value="build the password entropy regex lowercase" line="609"/>
      <comment value="build the password entropy regex numbers" line="618"/>
      <comment value="build the password entropy regex special" line="627"/>
      <comment value="regex entropy string" line="634"/>
    </inline>
  </method>
  <method name="_validateLength" start="648" end="667" abstract="false" final="true" static="false" visibility="protected">
    <inline>
      <comment value="validate that required indices exist" line="649"/>
      <todo value="Throw exception here" line="655"/>
      <comment value="determine which entropy to use (base or udf)" line="659"/>
    </inline>
  </method>
  <method name="_validatePolicy" start="669" end="704" abstract="false" final="true" static="false" visibility="protected">
    <inline>
      <comment value="validate that required indices exist" line="670"/>
      <todo value="Throw exception here" line="676"/>
      <comment value="determine which entropy to use (base or udf)" line="680"/>
      <comment value="check attempt limits" line="683"/>
      <comment value="check needs reset" line="694"/>
    </inline>
  </method>
  <method name="_validatePolicyAtChange" start="706" end="731" abstract="false" final="true" static="false" visibility="protected">
    <inline>
      <comment value="validate that required indices exist" line="707"/>
      <todo value="Throw exception here" line="713"/>
      <comment value="determine which entropy to use (base or udf)" line="717"/>
      <comment value="check password repeat" line="720"/>
    </inline>
  </method>
  <method name="_canChangePassword" start="733" end="753" abstract="false" final="true" static="false" visibility="protected">
    <inline>
      <comment value="validate that required indices exist" line="734"/>
      <todo value="Throw exception here" line="740"/>
      <comment value="Verify if the password was changed today or server has been futuredated" line="744"/>
      <comment value="Password was changed today or in the future" line="747"/>
    </inline>
  </method>
  <method name="getBaseEntropy" start="758" end="758" abstract="true" final="false" static="false" visibility="public">
    <docblock>
      <description compact="Abstract functions"/>
    </docblock>
  </method>
  <method name="getBaseEntropyOverride" start="759" end="759" abstract="true" final="false" static="false" visibility="public"/>
  <method name="getBasePasswordPolicy" start="760" end="760" abstract="true" final="false" static="false" visibility="public"/>
  <method name="getPasswordEntropyDescription" start="761" end="761" abstract="true" final="false" static="false" visibility="public"/>
  <method name="getPasswordLengthDescription" start="762" end="762" abstract="true" final="false" static="false" visibility="public"/>
  <method name="getPasswordPolicyDescription" start="763" end="763" abstract="true" final="false" static="false" visibility="public"/>
  <method name="getUdfEntropy" start="764" end="764" abstract="true" final="false" static="false" visibility="public"/>
  <method name="getUdfPasswordPolicy" start="765" end="765" abstract="true" final="false" static="false" visibility="public"/>
  <method name="setBaseEntropyOverride" start="766" end="766" abstract="true" final="false" static="false" visibility="public">
    <parameter name="toggle" byreference="false" type="{unknown}"/>
  </method>
  <method name="setUdfEntropy" start="767" end="767" abstract="true" final="false" static="false" visibility="public">
    <parameter name="entropyObj" byreference="false" type="{unknown}"/>
  </method>
  <method name="setUdfPasswordPolicy" start="768" end="768" abstract="true" final="false" static="false" visibility="public">
    <parameter name="entropyObj" byreference="false" type="{unknown}"/>
  </method>
  <method name="validateEntropy" start="769" end="769" abstract="true" final="false" static="false" visibility="public"/>
  <method name="validateLength" start="770" end="770" abstract="true" final="false" static="false" visibility="public"/>
  <method name="validatePolicy" start="771" end="771" abstract="true" final="false" static="false" visibility="public"/>
  <method name="validatePolicyAtChange" start="772" end="772" abstract="true" final="false" static="false" visibility="public"/>
  <method name="canChangePassword" start="773" end="773" abstract="true" final="false" static="false" visibility="public"/>
  <extender full="cymapgt\core\application\authentication\UserCredential\UserCredentialManager" namespace="cymapgt\core\application\authentication\UserCredential" name="UserCredentialManager"/>
</class>
